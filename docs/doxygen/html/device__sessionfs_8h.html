<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SessionFS - A session based VFS wrapper: src/kmodule/device_sessionfs.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="data-storage.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SessionFS - A session based VFS wrapper
   </div>
   <div id="projectbrief">Advanced Operating Systems and Virtualization - A.A. 2018/2019 Final Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('device__sessionfs_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">device_sessionfs.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Properties of the devices necessary for the device implementation and the library that uses the device, component of the <em>Character Device</em> submodule.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;linux/ioctl.h&gt;</code><br />
<code>#include &lt;linux/types.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for device_sessionfs.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="device__sessionfs_8h__incl.png" border="0" usemap="#src_2kmodule_2device__sessionfs_8h" alt=""/></div>
<map name="src_2kmodule_2device__sessionfs_8h" id="src_2kmodule_2device__sessionfs_8h">
<area shape="rect" title="Properties of the devices necessary for the device implementation and the library that uses the devic..." alt="" coords="43,5,192,47"/>
<area shape="rect" title=" " alt="" coords="5,95,104,121"/>
<area shape="rect" title=" " alt="" coords="128,95,235,121"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="device__sessionfs_8h__dep__incl.png" border="0" usemap="#src_2kmodule_2device__sessionfs_8hdep" alt=""/></div>
<map name="src_2kmodule_2device__sessionfs_8hdep" id="src_2kmodule_2device__sessionfs_8hdep">
<area shape="rect" title="Properties of the devices necessary for the device implementation and the library that uses the devic..." alt="" coords="208,5,357,47"/>
<area shape="rect" href="libsessionfs_8h.html" title="Shared library header." alt="" coords="80,102,285,129"/>
<area shape="rect" href="device__sessionfs_8c.html" title="Implementation of the virtual character device that will handle sessions, component of the Character ..." alt="" coords="309,95,459,136"/>
<area shape="rect" href="userspace__test_8c.html" title="Userpsace program that will test the kernel module using the libsessionfs.c shared library." alt="" coords="5,184,157,225"/>
<area shape="rect" href="libsessionfs_8c.html" title="Implementation of the userspace shared library." alt="" coords="182,191,386,218"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsess__params.html">sess_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a79f2713d570c7065f61a160134ea765b"><td class="memItemLeft" align="right" valign="top"><a id="a79f2713d570c7065f61a160134ea765b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a79f2713d570c7065f61a160134ea765b">CLASS_NAME</a>&#160;&#160;&#160;&quot;SessionFS_class&quot;</td></tr>
<tr class="memdesc:a79f2713d570c7065f61a160134ea765b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The name of the corresponding device class. <br /></td></tr>
<tr class="separator:a79f2713d570c7065f61a160134ea765b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f5a2c9450ebc584b4fe743c6b1a280b"><td class="memItemLeft" align="right" valign="top"><a id="a5f5a2c9450ebc584b4fe743c6b1a280b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a5f5a2c9450ebc584b4fe743c6b1a280b">DEVICE_NAME</a>&#160;&#160;&#160;&quot;SessionFS_dev&quot;</td></tr>
<tr class="memdesc:a5f5a2c9450ebc584b4fe743c6b1a280b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The name of our virtual device. <br /></td></tr>
<tr class="separator:a5f5a2c9450ebc584b4fe743c6b1a280b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7308a2976243cacd2a6e67cf778b6bac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a7308a2976243cacd2a6e67cf778b6bac">IOCTL_CLOSE_SESSION</a>&#160;&#160;&#160;_IOWR(<a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>,<a class="el" href="device__sessionfs_8h.html#a93883829481d6ee1889e1d112de35539">IOCTL_SEQ_CLOSE</a>,struct <a class="el" href="structsess__params.html">sess_params</a>*)</td></tr>
<tr class="memdesc:a7308a2976243cacd2a6e67cf778b6bac"><td class="mdescLeft">&#160;</td><td class="mdescRight">We define the ioctl command for closing a session.  <a href="device__sessionfs_8h.html#a7308a2976243cacd2a6e67cf778b6bac">More...</a><br /></td></tr>
<tr class="separator:a7308a2976243cacd2a6e67cf778b6bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39fa745d11d96b545af1516acfbf5cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#ac39fa745d11d96b545af1516acfbf5cc">IOCTL_DEVICE_SHUTDOWN</a>&#160;&#160;&#160;_IOR(<a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>,<a class="el" href="device__sessionfs_8h.html#abb7e01390a965ee816c314ea918552d1">IOCTL_SEQ_SHUTDOWN</a>,int*)</td></tr>
<tr class="memdesc:ac39fa745d11d96b545af1516acfbf5cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">We define the ioctl command fot asking a device shutdown.  <a href="device__sessionfs_8h.html#ac39fa745d11d96b545af1516acfbf5cc">More...</a><br /></td></tr>
<tr class="separator:ac39fa745d11d96b545af1516acfbf5cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf4f74a739a2b934f13ece487d9760d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#aaf4f74a739a2b934f13ece487d9760d9">IOCTL_OPEN_SESSION</a>&#160;&#160;&#160;_IOWR(<a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>,<a class="el" href="device__sessionfs_8h.html#ae2ad458a991106f7ca77b27d255735ca">IOCTL_SEQ_OPEN</a>,struct <a class="el" href="structsess__params.html">sess_params</a>*)</td></tr>
<tr class="memdesc:aaf4f74a739a2b934f13ece487d9760d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">We define the ioctl command for opening a session.  <a href="device__sessionfs_8h.html#aaf4f74a739a2b934f13ece487d9760d9">More...</a><br /></td></tr>
<tr class="separator:aaf4f74a739a2b934f13ece487d9760d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93883829481d6ee1889e1d112de35539"><td class="memItemLeft" align="right" valign="top"><a id="a93883829481d6ee1889e1d112de35539"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a93883829481d6ee1889e1d112de35539">IOCTL_SEQ_CLOSE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a93883829481d6ee1889e1d112de35539"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ioctl sequence number that idenfies the closing of a session. <br /></td></tr>
<tr class="separator:a93883829481d6ee1889e1d112de35539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ad458a991106f7ca77b27d255735ca"><td class="memItemLeft" align="right" valign="top"><a id="ae2ad458a991106f7ca77b27d255735ca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#ae2ad458a991106f7ca77b27d255735ca">IOCTL_SEQ_OPEN</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ae2ad458a991106f7ca77b27d255735ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ioctl sequence number that indenfies the opening of a session. <br /></td></tr>
<tr class="separator:ae2ad458a991106f7ca77b27d255735ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb7e01390a965ee816c314ea918552d1"><td class="memItemLeft" align="right" valign="top"><a id="abb7e01390a965ee816c314ea918552d1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#abb7e01390a965ee816c314ea918552d1">IOCTL_SEQ_SHUTDOWN</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:abb7e01390a965ee816c314ea918552d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ioctl sequence number that idenfies the request for the device shutdown. <br /></td></tr>
<tr class="separator:abb7e01390a965ee816c314ea918552d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e1fd8673bffdf4a406b5c119e542bdd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>&#160;&#160;&#160;120</td></tr>
<tr class="separator:a0e1fd8673bffdf4a406b5c119e542bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6100134634836ba2329f3da20696ff46"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a6100134634836ba2329f3da20696ff46">O_SESS</a>&#160;&#160;&#160;10000000</td></tr>
<tr class="memdesc:a6100134634836ba2329f3da20696ff46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag used to enable the Unix session semantic.  <a href="device__sessionfs_8h.html#a6100134634836ba2329f3da20696ff46">More...</a><br /></td></tr>
<tr class="separator:a6100134634836ba2329f3da20696ff46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572282928d464e8d81b724eefce60509"><td class="memItemLeft" align="right" valign="top"><a id="a572282928d464e8d81b724eefce60509"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="device__sessionfs_8h.html#a572282928d464e8d81b724eefce60509">VALID_SESS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a572282928d464e8d81b724eefce60509"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the validity of a session. <br /></td></tr>
<tr class="separator:a572282928d464e8d81b724eefce60509"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Properties of the devices necessary for the device implementation and the library that uses the device, component of the <em>Character Device</em> submodule. </p>
<p>This file contains some general device properties, such as the available ioctls and the device name that are needed to the file that will implement the device and to the library the will use the ioctls. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7308a2976243cacd2a6e67cf778b6bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7308a2976243cacd2a6e67cf778b6bac">&#9670;&nbsp;</a></span>IOCTL_CLOSE_SESSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IOCTL_CLOSE_SESSION&#160;&#160;&#160;_IOWR(<a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>,<a class="el" href="device__sessionfs_8h.html#a93883829481d6ee1889e1d112de35539">IOCTL_SEQ_CLOSE</a>,struct <a class="el" href="structsess__params.html">sess_params</a>*)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We define the ioctl command for closing a session. </p>
<p>We use the macro <code>_IOWR</code> since we need to pass to the virtual device the <code><a class="el" href="structsess__params.html">sess_params</a></code> struct. </p>

</div>
</div>
<a id="ac39fa745d11d96b545af1516acfbf5cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac39fa745d11d96b545af1516acfbf5cc">&#9670;&nbsp;</a></span>IOCTL_DEVICE_SHUTDOWN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IOCTL_DEVICE_SHUTDOWN&#160;&#160;&#160;_IOR(<a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>,<a class="el" href="device__sessionfs_8h.html#abb7e01390a965ee816c314ea918552d1">IOCTL_SEQ_SHUTDOWN</a>,int*)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We define the ioctl command fot asking a device shutdown. </p>
<p>We use the <code>_IOR</code> macro since the device will let the userspace program read the number of active sessions during shutdown. </p>

</div>
</div>
<a id="aaf4f74a739a2b934f13ece487d9760d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf4f74a739a2b934f13ece487d9760d9">&#9670;&nbsp;</a></span>IOCTL_OPEN_SESSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IOCTL_OPEN_SESSION&#160;&#160;&#160;_IOWR(<a class="el" href="device__sessionfs_8h.html#a0e1fd8673bffdf4a406b5c119e542bdd">MAJOR_NUM</a>,<a class="el" href="device__sessionfs_8h.html#ae2ad458a991106f7ca77b27d255735ca">IOCTL_SEQ_OPEN</a>,struct <a class="el" href="structsess__params.html">sess_params</a>*)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We define the ioctl command for opening a session. </p>
<p>We use the <code>_IOWR</code> macro since we need to pass to the virtual device the <code><a class="el" href="structsess__params.html">sess_params</a></code> struct. </p>

</div>
</div>
<a id="a0e1fd8673bffdf4a406b5c119e542bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e1fd8673bffdf4a406b5c119e542bdd">&#9670;&nbsp;</a></span>MAJOR_NUM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAJOR_NUM&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A major device number is necessary to identify our virtual device, since it doensn't have an assigned letter. We use 120 as major number since it reserved for local and experimental use. See: Documentation/admin-guide/devices.txt </p>

</div>
</div>
<a id="a6100134634836ba2329f3da20696ff46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6100134634836ba2329f3da20696ff46">&#9670;&nbsp;</a></span>O_SESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define O_SESS&#160;&#160;&#160;10000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag used to enable the Unix session semantic. </p>
<p>Unused flag in <code>include/uapi/asm-generic/fcntl.h</code>, that has been repurposed. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b6e26c987379c818ae1a7be6334a2c88.html">kmodule</a></li><li class="navelem"><a class="el" href="device__sessionfs_8h.html">device_sessionfs.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
